syntax = "proto3";

//buf:lint:ignore PACKAGE_VERSION_SUFFIX
// Some doc
package authpb;

import "google/api/annotations.proto";
// import "protoc-gen-openapiv2/options/annotations.proto";

service AuthSvc {
  rpc CreateAuth(CreateAuthRequest) returns (CreateAuthResponse) {
    option (google.api.http) = {
      post: "/v1/auth/create";
      body: "*";
    };
  };
  rpc LoginPasswd(LoginPasswdRequest) returns (LoginPasswdResponse) {
    option (google.api.http) = {
      post: "/v1/auth/login/passwd";
      body: "*";
    };
  };
  rpc LoginOauth2(LoginOauth2Request) returns (LoginOauth2Response) {
    option (google.api.http) = {
      post: "/v1/auth/login/oauth2";
      body: "*";
    };
  };
  rpc ValidateToken(ValidateTokenRequest) returns (ValidateTokenResponse) {
    option (google.api.http) = {
      post: "/v1/auth/validate";
      body: "*";
    };
  };
  rpc UpdatePasswd(UpdatePasswdRequest) returns (UpdatePasswdResponse) {
    option (google.api.http) = {
      get: "/v1/auth/update/passwd";
    };
  };
  rpc ListAuth(ListAuthRequest) returns (ListAuthResponse) {
    option (google.api.http) = {
      get: "/v1/auth/list";
    };
  };
  rpc GetOauth2Config(GetOauth2ConfigRequest) returns (GetOauth2ConfigResponse) {
    option (google.api.http) = {
      get: "/v1/auth/oauth2/config";
    };
  };
}

message GetOauth2ConfigRequest{
}

message Oauth2ConfigPayload{
  string endpoint = 1;
  string client_id = 2;
  string redirect_uri = 3;
  string response_type = 4;
  string scope = 5;
  string include_granted_scopes = 6;
}

message GetOauth2ConfigResponse{
  Oauth2ConfigPayload payload = 1;
}

message CreateAuthRequest {
}
message CreateAuthResponse {
}

message ListAuthRequest {}
message ListAuthResponse {}

message LoginPasswdRequest {
  string email = 1;
  string password = 2;
}

message LoginPasswdPayload{
  string email = 1;
  string token = 2;
}

message LoginPasswdResponse {
  LoginPasswdPayload payload = 1;
}

message UpdatePasswdRequest {
  string email = 1;
  string password = 2;
  string new_password = 3;
}

message UpdatePasswdResponse {}
message ValidateTokenRequest {}
message ValidateTokenResponse {}

message LoginOauth2Request {
  string state = 1;
	string code = 2;
	string provider = 3;
	string redirect_url = 4;
}

message LoginOauth2Response {
  LoginPasswdPayload payload = 1;
}
